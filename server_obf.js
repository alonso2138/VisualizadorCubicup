const a0_0x353bb4=a0_0x24c7;(function(_0x1ac9e7,_0x2df522){const _0x523ad3=a0_0x24c7,_0x37dea8=_0x1ac9e7();while(!![]){try{const _0x4ffd18=parseInt(_0x523ad3(0x107))/0x1+-parseInt(_0x523ad3(0x10c))/0x2*(-parseInt(_0x523ad3(0x9e))/0x3)+parseInt(_0x523ad3(0xdb))/0x4+parseInt(_0x523ad3(0xa1))/0x5*(-parseInt(_0x523ad3(0x92))/0x6)+-parseInt(_0x523ad3(0xc7))/0x7+parseInt(_0x523ad3(0xc2))/0x8+-parseInt(_0x523ad3(0xb3))/0x9;if(_0x4ffd18===_0x2df522)break;else _0x37dea8['push'](_0x37dea8['shift']());}catch(_0x51909c){_0x37dea8['push'](_0x37dea8['shift']());}}}(a0_0x13c2,0xd6299));const express=require(a0_0x353bb4(0x8f)),path=require('path'),multer=require('multer'),fs=require(a0_0x353bb4(0xf3)),{execSync}=require(a0_0x353bb4(0x10d)),cors=require(a0_0x353bb4(0x8e)),cron=require(a0_0x353bb4(0xcf)),{Console}=require(a0_0x353bb4(0xe7)),app=express(),port=process[a0_0x353bb4(0xc8)]['PORT']||0xbb8;app[a0_0x353bb4(0x106)](cors()),app[a0_0x353bb4(0x106)](express[a0_0x353bb4(0x8a)]()),app[a0_0x353bb4(0x106)]((_0x458be1,_0x3dba6f,_0x3df79d)=>{const _0x26cf0e=a0_0x353bb4;_0x458be1[_0x26cf0e(0x98)]['endsWith'](_0x26cf0e(0x109))&&_0x3dba6f['setHeader'](_0x26cf0e(0xf7),_0x26cf0e(0x95)),_0x3df79d();}),app[a0_0x353bb4(0x106)](express[a0_0x353bb4(0xeb)](path[a0_0x353bb4(0xd8)](__dirname,'dist'))),app['use'](a0_0x353bb4(0x110),express[a0_0x353bb4(0xeb)](path[a0_0x353bb4(0xd8)](__dirname,a0_0x353bb4(0xb6)))),app['use'](a0_0x353bb4(0xfe),express['static'](path[a0_0x353bb4(0xd8)](__dirname,'dist/uploads')));const uploadDir=path[a0_0x353bb4(0xd8)](__dirname,a0_0x353bb4(0x111));fs[a0_0x353bb4(0xe3)](uploadDir);const gituploadsDir=path['join'](__dirname,a0_0x353bb4(0xd0),a0_0x353bb4(0x111));fs[a0_0x353bb4(0xe3)](gituploadsDir);const projectsDir=path[a0_0x353bb4(0xd8)](__dirname,a0_0x353bb4(0x7d));fs[a0_0x353bb4(0xe3)](projectsDir),console[a0_0x353bb4(0x9d)]('Projects\x20Directory:',projectsDir);const upload=multer({'storage':multer[a0_0x353bb4(0xd6)]({'destination':function(_0x14d871,_0x42119b,_0x14238d){_0x14238d(null,uploadDir);},'filename':function(_0x5e1165,_0x18b247,_0x428f82){const _0x5f40c8=a0_0x353bb4,_0x41e58b=Date[_0x5f40c8(0x88)]()+'-'+Math['round'](Math[_0x5f40c8(0x78)]()*0x3b9aca00),_0x700a89=path['extname'](_0x18b247[_0x5f40c8(0xa7)]),_0x355b23=path['basename'](_0x18b247[_0x5f40c8(0xa7)],_0x700a89)+'-'+_0x41e58b+_0x700a89;_0x428f82(null,_0x355b23);}}),'limits':{'fileSize':0x3e8*0x400*0x400}});function a0_0x24c7(_0x302a3d,_0x608eb){const _0x13c2aa=a0_0x13c2();return a0_0x24c7=function(_0x24c7d7,_0x306fe1){_0x24c7d7=_0x24c7d7-0x74;let _0x5b4dbf=_0x13c2aa[_0x24c7d7];return _0x5b4dbf;},a0_0x24c7(_0x302a3d,_0x608eb);}async function commitFileToGitHub(_0x5e7e58,_0x33d6fe){const _0x5e064e=a0_0x353bb4;try{const _0x2da6b9=_0x5e064e(0xba)+Date[_0x5e064e(0x88)](),_0x20cac4=path['join'](gituploadsDir,_0x2da6b9);fs[_0x5e064e(0xe3)](_0x20cac4);const _0x5e59f9=path[_0x5e064e(0xd8)](_0x20cac4,_0x33d6fe);return fs[_0x5e064e(0xaa)](_0x5e7e58,_0x5e59f9),execSync('git\x20add\x20.',{'cwd':__dirname}),execSync('git\x20commit\x20-m\x20\x22Add\x20new\x20model:\x20'+_0x33d6fe+'\x22',{'cwd':__dirname}),execSync('git\x20push\x20origin\x20main',{'cwd':__dirname}),console['log'](_0x5e064e(0xc3)+_0x33d6fe+_0x5e064e(0xcd)),!![];}catch(_0x4f1939){return console[_0x5e064e(0x7c)](_0x5e064e(0xe6),_0x4f1939),![];}}app[a0_0x353bb4(0x106)](a0_0x353bb4(0xfe),express[a0_0x353bb4(0xeb)](path[a0_0x353bb4(0xd8)](__dirname,a0_0x353bb4(0x111))));const temporaryFiles=new Set();app[a0_0x353bb4(0xf1)](a0_0x353bb4(0xf4),upload[a0_0x353bb4(0xbb)](a0_0x353bb4(0xee)),async(_0x214a21,_0x4586df)=>{const _0x3dd7a5=a0_0x353bb4;console[_0x3dd7a5(0x9d)](_0x3dd7a5(0xdd));try{if(!_0x214a21[_0x3dd7a5(0x10a)])return console[_0x3dd7a5(0x7c)](_0x3dd7a5(0xa8)),_0x4586df['status'](0x190)[_0x3dd7a5(0x8a)]({'error':'No\x20file\x20uploaded'});console[_0x3dd7a5(0x9d)](_0x3dd7a5(0x103),_0x214a21['file']),temporaryFiles[_0x3dd7a5(0x86)](_0x214a21['file']['filename']);const _0x3258c9=path[_0x3dd7a5(0xd8)](__dirname,_0x3dd7a5(0x111),_0x214a21[_0x3dd7a5(0x10a)]['filename']);setTimeout(()=>{const _0x52bf1c=_0x3dd7a5;temporaryFiles[_0x52bf1c(0xf8)](_0x214a21[_0x52bf1c(0x10a)]['filename'])&&fs[_0x52bf1c(0xdf)](_0x3258c9,_0x5656a7=>{const _0xab9fb4=_0x52bf1c;_0x5656a7?console['error'](_0xab9fb4(0x108),_0x5656a7):(console[_0xab9fb4(0x9d)](_0xab9fb4(0x8d)+_0x214a21[_0xab9fb4(0x10a)][_0xab9fb4(0x7b)]),temporaryFiles['delete'](_0x214a21['file'][_0xab9fb4(0x7b)]));});},0x3c*0x3c*0x3e8),_0x4586df[_0x3dd7a5(0x8a)]({'success':!![],'file':_0x214a21[_0x3dd7a5(0x10a)]['filename'],'path':_0x3dd7a5(0xfc)+_0x214a21[_0x3dd7a5(0x10a)][_0x3dd7a5(0x7b)]});}catch(_0x4a7407){console[_0x3dd7a5(0x7c)](_0x3dd7a5(0xac),_0x4a7407),_0x4586df['status'](0x1f4)[_0x3dd7a5(0x8a)]({'error':_0x4a7407[_0x3dd7a5(0x119)]||_0x3dd7a5(0xed)});}});function saveProjectToDatabase(_0x131352){const _0x17c8ee=a0_0x353bb4;try{const _0x31534f=path[_0x17c8ee(0xd8)](projectsDir,_0x131352[_0x17c8ee(0xa4)]+_0x17c8ee(0x10e));console[_0x17c8ee(0x9d)](_0x17c8ee(0xa2),_0x31534f),fs[_0x17c8ee(0xd5)](_0x31534f,JSON[_0x17c8ee(0xe0)](_0x131352,null,0x2)),console['log'](_0x17c8ee(0x74)+_0x31534f);}catch(_0x56d73f){console[_0x17c8ee(0x7c)](_0x17c8ee(0x97),_0x56d73f);throw _0x56d73f;}}function a0_0x13c2(){const _0x3ce822=['charAt','originalname','No\x20file\x20received','updateStatusForLoadedModel','copyFileSync','schedule','Temporary\x20upload\x20error:','mtime','.glb','\x20removal\x20committed\x20to\x20GitHub','replace','includes','libro-azul','13640283PRBfCc','git\x20commit\x20-m\x20\x22Remove\x20model:\x20','/api/texture-materials','dist/datos','basename','Error\x20fetching\x20groups:','Project\x20saved\x20successfully','model_','single','projectData','Express\x20server\x20listening\x20on\x20port\x20%d\x20in\x20%s\x20mode','unlinkSync','Project\x20not\x20found','sendFile','\x20deleted\x20from\x20uploads','11587600rOQphh','Model\x20','utf8','Trying\x20to\x20deliver\x20project:','split','8186402FNQEoL','env','groups','Failed\x20to\x20list\x20projects','forEach','isDirectory','\x20committed\x20and\x20pushed\x20to\x20GitHub','target','node-cron','public','extname','\x20not\x20found','dist','modelPath','writeFileSync','diskStorage','settings','join','params','git\x20push\x20origin\x20main','2352148lNfnSR','.gltf','Temporary\x20upload\x20request\x20received','Failed\x20to\x20fetch\x20group\x20data','unlink','stringify','Project\x20','Failed\x20to\x20fetch\x20texture\x20materials','ensureDirSync','Running\x20cleanup\x20for\x20temporary\x20uploads...','values','Git\x20operation\x20failed:','console','/api/delete-temp-file/:filename','modelLoaded','DELETE','static','slice','Temporary\x20upload\x20failed','model','readdirSync','/api/groups','post','append','fs-extra','/upload','Api\x20groups\x20called','delete','Content-Type','has','toLowerCase','Error:\x20index.html\x20not\x20found','/api/projects/:id','/uploads/','File\x20not\x20found\x20or\x20not\x20marked\x20as\x20temporary','/uploads','statusText','Sending\x20Projects:','map','Server\x20configuration\x20error:\x20index.html\x20not\x20found','File\x20temporarily\x20saved:','-groups.json','libro-azul.json','use','940548PGBemB','Error\x20deleting\x20temporary\x20file:','.js','file','Project\x20loaded:\x20','166kTLBNG','child_process','.json','files','/datos','uploads','filter','/materiales','parse','git\x20add\x20.','listen','index.html','\x20and\x20its\x20associated\x20data\x20deleted\x20from\x20uploads','message','Project\x20saved\x20successfully:\x20','/api/projects','readFileSync','Invalid\x20project\x20data:\x20\x22name\x22\x20is\x20required','random','endsWith','Libro\x20Azul\x20file\x20not\x20found','filename','error','projects','Error\x20listing\x20group\x20files:','Error\x20deleting\x20project:','existsSync','pop','get','Error\x20fetching\x20texture\x20materials:','Received\x20Project\x20Data:','/api/libro-azul','add','Invalid\x20project\x20data:\x20\x22modelPath\x22\x20is\x20required','now','ceilingHeight','json','renameSync','status','Deleted\x20temporary\x20file:\x20','cors','express','Error\x20fetching\x20libro-azul:','toUpperCase','6XVBhoc','adminInterface','Failed\x20to\x20list\x20group\x20files','application/javascript','Modelo\x20cargado\x20correctamente','Error\x20saving\x20project:','path','showNotification','Error\x20loading\x20project:','Error\x20listing\x20projects:','removeSync','log','56607jIsqYb','statSync','Failed\x20to\x20save\x20project','4904400cjzmvz','Saving\x20Project\x20to:','POST','name','warn'];a0_0x13c2=function(){return _0x3ce822;};return a0_0x13c2();}function getProjectFromDatabase(_0x4823eb){const _0x3d6400=a0_0x353bb4;try{const _0x37f860=path['join'](projectsDir,_0x4823eb+_0x3d6400(0x10e));if(fs[_0x3d6400(0x80)](_0x37f860)){const _0x2dd9a1=JSON[_0x3d6400(0x114)](fs[_0x3d6400(0x76)](_0x37f860,_0x3d6400(0xc4)));return console[_0x3d6400(0x9d)](_0x3d6400(0x10b)+_0x37f860),_0x2dd9a1;}else return console[_0x3d6400(0xa5)]('Project\x20not\x20found:\x20'+_0x37f860),null;}catch(_0xd18015){console[_0x3d6400(0x7c)](_0x3d6400(0x9a),_0xd18015);throw _0xd18015;}}app['post']('/api/projects',(_0x1c2eee,_0x4a25f8)=>{const _0x2f8374=a0_0x353bb4;try{const _0x4ca8bb=_0x1c2eee['body']['projectData'];console[_0x2f8374(0x9d)](_0x2f8374(0x84),_0x4ca8bb);if(!_0x4ca8bb||!_0x4ca8bb[_0x2f8374(0xa4)])throw new Error(_0x2f8374(0x77));if(!_0x4ca8bb[_0x2f8374(0xd4)])throw new Error(_0x2f8374(0x87));const _0x1f7e3b=path[_0x2f8374(0xd8)](__dirname,_0x4ca8bb['modelPath']),_0x3727fd=path[_0x2f8374(0xd8)](__dirname,_0x2f8374(0x111),_0x4ca8bb[_0x2f8374(0xa4)]+_0x2f8374(0xae));fs[_0x2f8374(0x8b)](_0x1f7e3b,_0x3727fd),_0x4ca8bb[_0x2f8374(0xd4)]='/uploads/'+_0x4ca8bb[_0x2f8374(0xa4)]+'.glb';const _0x253ebf=_0x4ca8bb[_0x2f8374(0xd4)]['split']('/')[_0x2f8374(0x81)]();temporaryFiles['delete'](_0x253ebf),saveProjectToDatabase(_0x4ca8bb),_0x4a25f8['status'](0xc9)['json']({'message':_0x2f8374(0xb9),'project':_0x4ca8bb});}catch(_0x12e181){console['error'](_0x2f8374(0x97),_0x12e181),_0x4a25f8['status'](0x1f4)[_0x2f8374(0x8a)]({'error':_0x2f8374(0xa0)});}}),app[a0_0x353bb4(0x82)](a0_0x353bb4(0x75),(_0x1d57ee,_0x5f1583)=>{const _0xf376bf=a0_0x353bb4;console['log'](_0xf376bf(0x100));try{const _0x107e04=fs[_0xf376bf(0xef)](projectsDir),_0x3a7b45=fs[_0xf376bf(0x80)](uploadDir)?fs[_0xf376bf(0xef)](uploadDir):[];console[_0xf376bf(0x9d)](_0x3a7b45);const _0x394afc=[..._0x3a7b45[_0xf376bf(0x112)](_0x24a051=>path[_0xf376bf(0xd1)](_0x24a051)[_0xf376bf(0xf9)]()===_0xf376bf(0xae))[_0xf376bf(0x101)](_0x3bf99e=>{const _0x5352fe=_0xf376bf,_0x2e9ce5=fs['statSync'](path[_0x5352fe(0xd8)](uploadDir,_0x3bf99e)),_0x34832f=path[_0x5352fe(0x114)](_0x3bf99e)[_0x5352fe(0xa4)];console[_0x5352fe(0x9d)](_0x2e9ce5);const _0x3b2673=path[_0x5352fe(0xd8)](projectsDir,_0x34832f+_0x5352fe(0x104)),_0x1e5f58=fs[_0x5352fe(0x80)](_0x3b2673)?JSON['parse'](fs[_0x5352fe(0x76)](_0x3b2673,'utf8')):null;return{'id':_0x34832f,'name':_0x3bf99e,'path':_0x5352fe(0xfc)+_0x3bf99e,'date':_0x2e9ce5[_0x5352fe(0xad)],'groups':_0x1e5f58,'ceilingHeight':_0x1e5f58?.[_0x5352fe(0x89)]||null};}),..._0x107e04[_0xf376bf(0x112)](_0x292132=>fs[_0xf376bf(0x9f)](path[_0xf376bf(0xd8)](projectsDir,_0x292132))[_0xf376bf(0xcc)]())[_0xf376bf(0x101)](_0x3bf3fa=>{const _0x39f967=_0xf376bf,_0x3542e0=path['join'](projectsDir,_0x3bf3fa),_0x4d4139=fs[_0x39f967(0xef)](_0x3542e0)[_0x39f967(0x112)](_0x3727d2=>path[_0x39f967(0xd1)](_0x3727d2)[_0x39f967(0xf9)]()===_0x39f967(0xae));if(_0x4d4139['length']===0x0)return null;const _0x4530e2=fs[_0x39f967(0x9f)](_0x3542e0);return{'id':_0x3bf3fa,'name':_0x3bf3fa+'\x20('+_0x4d4139[0x0]+')','path':_0x39f967(0xfc)+_0x3bf3fa+'/'+_0x4d4139[0x0],'date':_0x4530e2[_0x39f967(0xad)]};})[_0xf376bf(0x112)](_0x2cdaf9=>_0x2cdaf9!==null)];console[_0xf376bf(0x9d)](_0x394afc),_0x5f1583['json'](_0x394afc);}catch(_0x2efa4f){console[_0xf376bf(0x7c)](_0xf376bf(0x9b),_0x2efa4f),_0x5f1583[_0xf376bf(0x8c)](0x1f4)[_0xf376bf(0x8a)]({'error':_0xf376bf(0xca)});}}),app[a0_0x353bb4(0x82)](a0_0x353bb4(0xfb),(_0x2995d2,_0x74d8cd)=>{const _0x2ce557=a0_0x353bb4,_0x2ce939=_0x2995d2['params']['id'];console[_0x2ce557(0x9d)](_0x2ce557(0xc5),_0x2ce939);try{const _0x5807e2=getProjectFromDatabase(_0x2ce939);if(_0x5807e2){const _0xfc71e=path[_0x2ce557(0xd8)](uploadDir,_0x2ce939+_0x2ce557(0x104));fs[_0x2ce557(0x80)](_0xfc71e)&&(_0x5807e2[_0x2ce557(0xc9)]=JSON['parse'](fs['readFileSync'](_0xfc71e,_0x2ce557(0xc4)))),_0x74d8cd[_0x2ce557(0x8a)](_0x5807e2);}else _0x74d8cd[_0x2ce557(0x8c)](0x194)[_0x2ce557(0x8a)]({'error':_0x2ce557(0xbf)});}catch(_0x2d0223){console[_0x2ce557(0x7c)](_0x2ce557(0x9a),_0x2d0223),_0x74d8cd[_0x2ce557(0x8c)](0x1f4)[_0x2ce557(0x8a)]({'error':'Failed\x20to\x20load\x20project'});}}),app['delete'](a0_0x353bb4(0xfb),(_0x3c54c4,_0x4d50d8)=>{const _0x570293=a0_0x353bb4;try{const _0x2cc2df=_0x3c54c4['params']['id'],_0x3c56cc=path[_0x570293(0xd8)](projectsDir,_0x2cc2df)+'.json',_0x44fb57=path['join'](uploadDir,_0x2cc2df)+_0x570293(0xae);if(fs[_0x570293(0x80)](_0x44fb57))fs['unlinkSync'](_0x44fb57),console[_0x570293(0x9d)]('Deleted\x20model\x20file:\x20'+_0x44fb57),fs[_0x570293(0x80)](_0x3c56cc)&&(fs[_0x570293(0xbe)](_0x3c56cc),console[_0x570293(0x9d)]('Deleted\x20associated\x20groups\x20file:\x20'+_0x3c56cc)),_0x4d50d8['json']({'success':!![],'message':_0x570293(0xe1)+_0x2cc2df+_0x570293(0x118)});else{if(fs[_0x570293(0x80)](uploadsPath)&&fs[_0x570293(0x9f)](uploadsPath)[_0x570293(0xcc)]()){fs[_0x570293(0x9c)](uploadsPath);try{execSync(_0x570293(0x115),{'cwd':__dirname}),execSync(_0x570293(0xb4)+_0x2cc2df+'\x22',{'cwd':__dirname}),execSync(_0x570293(0xda),{'cwd':__dirname}),console['log'](_0x570293(0xc3)+_0x2cc2df+_0x570293(0xaf));}catch(_0xa0570d){console[_0x570293(0x7c)](_0x570293(0xe6),_0xa0570d);}_0x4d50d8[_0x570293(0x8a)]({'success':!![],'message':_0x570293(0xe1)+_0x2cc2df+_0x570293(0xc1)});}else _0x4d50d8[_0x570293(0x8c)](0x194)['json']({'error':'Project\x20'+_0x2cc2df+_0x570293(0xd2)});}}catch(_0x82d14e){console['error'](_0x570293(0x7f),_0x82d14e),_0x4d50d8['status'](0x1f4)['json']({'error':'Failed\x20to\x20delete\x20project'});}}),app[a0_0x353bb4(0x82)](a0_0x353bb4(0xf0),(_0x366a18,_0xa86bf7)=>{const _0xdb4cf5=a0_0x353bb4;try{const _0x25aa18=fs[_0xdb4cf5(0xef)](uploadDir)['filter'](_0x541931=>_0x541931[_0xdb4cf5(0x79)](_0xdb4cf5(0x104))),_0x150150=_0x25aa18[_0xdb4cf5(0x101)](_0x2ed28a=>{const _0x64bc87=_0xdb4cf5,_0x5dc3ed=_0x2ed28a[_0x64bc87(0xb0)](_0x64bc87(0x104),'');return{'id':_0x5dc3ed,'file':_0x2ed28a};});_0xa86bf7[_0xdb4cf5(0x8a)](_0x150150);}catch(_0x43a0ef){console['error'](_0xdb4cf5(0x7e),_0x43a0ef),_0xa86bf7[_0xdb4cf5(0x8c)](0x1f4)['json']({'error':_0xdb4cf5(0x94)});}}),app['get']('/api/groups/:modelId',(_0x560b2e,_0x34aa67)=>{const _0x3f70f4=a0_0x353bb4;console['log'](_0x3f70f4(0xf5));try{const _0x2cba17=_0x560b2e[_0x3f70f4(0xd9)]['modelId'],_0x1635f2=decodeURIComponent(_0x2cba17);let _0x522b54;if(_0x1635f2[_0x3f70f4(0xb1)]('/')){const _0x148f0a=_0x1635f2[_0x3f70f4(0xc6)]('/');_0x522b54=path[_0x3f70f4(0x114)](_0x148f0a[_0x148f0a['length']-0x1])['name'];}else _0x522b54=path[_0x3f70f4(0x114)](_0x1635f2)['name'];const _0x395c03=path[_0x3f70f4(0xd8)](uploadDir,_0x522b54+_0x3f70f4(0x104));if(fs[_0x3f70f4(0x80)](_0x395c03)){const _0x484278=JSON[_0x3f70f4(0x114)](fs[_0x3f70f4(0x76)](_0x395c03,_0x3f70f4(0xc4)));_0x34aa67[_0x3f70f4(0x8a)](_0x484278),console[_0x3f70f4(0x9d)](_0x484278);}else _0x34aa67['json']({'groups':[],'ceilingHeight':null});}catch(_0x4fcbc2){console[_0x3f70f4(0x7c)](_0x3f70f4(0xb8),_0x4fcbc2),_0x34aa67[_0x3f70f4(0x8c)](0x1f4)[_0x3f70f4(0x8a)]({'error':_0x3f70f4(0xde)});}}),app['get'](a0_0x353bb4(0xb5),(_0x5515ac,_0x4b0ff9)=>{const _0x36407d=a0_0x353bb4;try{const _0x3c39f9=path[_0x36407d(0xd8)](__dirname,'materiales'),_0x377b4f=fs[_0x36407d(0xef)](_0x3c39f9)[_0x36407d(0x112)](_0x58cb78=>fs[_0x36407d(0x9f)](path[_0x36407d(0xd8)](_0x3c39f9,_0x58cb78))[_0x36407d(0xcc)]()),_0x1192ec={};_0x377b4f[_0x36407d(0xcb)](_0x17d7c3=>{const _0x5016e9=_0x36407d,_0x5e4407=path['join'](_0x3c39f9,_0x17d7c3),_0x1d3570=fs[_0x5016e9(0xef)](_0x5e4407)[_0x5016e9(0x112)](_0x6dd3dc=>['.jpg','.jpeg','.png'][_0x5016e9(0xb1)](path[_0x5016e9(0xd1)](_0x6dd3dc)[_0x5016e9(0xf9)]()))[_0x5016e9(0x101)](_0x4dbed1=>{const _0x30d9c4=_0x5016e9,_0xeff28a='/materiales/'+_0x17d7c3+'/'+_0x4dbed1,_0xb49306=path[_0x30d9c4(0xb7)](_0x4dbed1,path[_0x30d9c4(0xd1)](_0x4dbed1))[_0x30d9c4(0xb0)](/[-_]/g,'\x20')['replace'](/\b\w/g,_0x173306=>_0x173306[_0x30d9c4(0x91)]());return{'id':path[_0x30d9c4(0xb7)](_0x4dbed1,path['extname'](_0x4dbed1)),'name':_0xb49306,'path':_0xeff28a,'thumbnail':_0xeff28a,'family':_0x17d7c3};});_0x1192ec[_0x17d7c3]={'id':_0x17d7c3,'name':_0x17d7c3[_0x5016e9(0xa6)](0x0)['toUpperCase']()+_0x17d7c3[_0x5016e9(0xec)](0x1),'materials':_0x1d3570};});const _0x3dbf4f={'families':Object[_0x36407d(0xe5)](_0x1192ec)};_0x4b0ff9['json'](_0x3dbf4f);}catch(_0x2352c6){console[_0x36407d(0x7c)](_0x36407d(0x83),_0x2352c6),_0x4b0ff9[_0x36407d(0x8c)](0x1f4)['json']({'error':_0x36407d(0xe2)});}}),app[a0_0x353bb4(0x82)](a0_0x353bb4(0x85),(_0x31a8b7,_0x1fc907)=>{const _0x32dd9a=a0_0x353bb4;try{const _0x5c6223=path[_0x32dd9a(0xd8)](__dirname,_0x32dd9a(0xb2),_0x32dd9a(0x105));if(!fs['existsSync'](_0x5c6223))return _0x1fc907[_0x32dd9a(0x8c)](0x194)['json']({'error':_0x32dd9a(0x7a)});const _0x420183=fs['readFileSync'](_0x5c6223,_0x32dd9a(0xc4)),_0x33b69b=JSON[_0x32dd9a(0x114)](_0x420183);_0x1fc907['json'](_0x33b69b);}catch(_0x1fbe6d){console[_0x32dd9a(0x7c)](_0x32dd9a(0x90),_0x1fbe6d),_0x1fc907['status'](0x1f4)[_0x32dd9a(0x8a)]({'error':_0x32dd9a(0xe2)});}}),app['use'](a0_0x353bb4(0x113),express[a0_0x353bb4(0xeb)](path[a0_0x353bb4(0xd8)](__dirname,'materiales'))),app[a0_0x353bb4(0xf6)](a0_0x353bb4(0xe8),(_0x240974,_0x3451ee)=>{const _0x59f4bb=a0_0x353bb4,_0x2678ca=_0x240974[_0x59f4bb(0xd9)][_0x59f4bb(0x7b)],_0x1dcb6c=path[_0x59f4bb(0xd8)](__dirname,_0x59f4bb(0x111),_0x2678ca);temporaryFiles['has'](_0x2678ca)?fs[_0x59f4bb(0xdf)](_0x1dcb6c,_0x445a28=>{const _0x141f6b=_0x59f4bb;if(_0x445a28)return console[_0x141f6b(0x7c)](_0x141f6b(0x108),_0x445a28),_0x3451ee['status'](0x1f4)[_0x141f6b(0x8a)]({'error':'Failed\x20to\x20delete\x20temporary\x20file'});console[_0x141f6b(0x9d)](_0x141f6b(0x8d)+_0x2678ca),temporaryFiles['delete'](_0x2678ca),_0x3451ee[_0x141f6b(0x8a)]({'success':!![]});}):_0x3451ee[_0x59f4bb(0x8c)](0x194)[_0x59f4bb(0x8a)]({'error':_0x59f4bb(0xfd)});}),cron[a0_0x353bb4(0xab)]('0\x200\x20*\x20*\x20*',()=>{const _0x13c9e1=a0_0x353bb4;console[_0x13c9e1(0x9d)](_0x13c9e1(0xe4));const _0x2da6a7=path[_0x13c9e1(0xd8)](__dirname,_0x13c9e1(0x111));fs['readdir'](_0x2da6a7,(_0x7540db,_0x384c41)=>{const _0x4ef046=_0x13c9e1;if(_0x7540db){console[_0x4ef046(0x7c)]('Error\x20reading\x20uploads\x20directory:',_0x7540db);return;}_0x384c41[_0x4ef046(0xcb)](_0x417773=>{const _0x56ea84=_0x4ef046,_0x2686a6=path[_0x56ea84(0xd8)](_0x2da6a7,_0x417773);temporaryFiles['has'](_0x417773)&&fs[_0x56ea84(0xdf)](_0x2686a6,_0x390687=>{const _0x3254e9=_0x56ea84;_0x390687?console[_0x3254e9(0x7c)](_0x3254e9(0x108),_0x390687):(console[_0x3254e9(0x9d)]('Deleted\x20orphaned\x20temporary\x20file:\x20'+_0x417773),temporaryFiles[_0x3254e9(0xf6)](_0x417773));});});});}),app[a0_0x353bb4(0x106)]((_0x3e64d1,_0x12a5f4)=>{const _0x2f8625=a0_0x353bb4,_0x4555a0=path[_0x2f8625(0xd8)](__dirname,_0x2f8625(0xd3),_0x2f8625(0x117));fs[_0x2f8625(0x80)](_0x4555a0)?_0x12a5f4[_0x2f8625(0xc0)](_0x4555a0):(console[_0x2f8625(0x7c)](_0x2f8625(0xfa)),_0x12a5f4[_0x2f8625(0x8c)](0x1f4)['send'](_0x2f8625(0x102)));}),app[a0_0x353bb4(0x116)](port,function(){const _0x28b474=a0_0x353bb4;console['log'](_0x28b474(0xbd),port,app[_0x28b474(0xd7)][_0x28b474(0xc8)]);});async function handleFileSelected(_0x17460b){const _0x13e9b5=a0_0x353bb4,_0x91563e=_0x17460b[_0x13e9b5(0xce)][_0x13e9b5(0x10f)][0x0];if(!_0x91563e)return;if(!_0x91563e[_0x13e9b5(0xa4)][_0x13e9b5(0xf9)]()[_0x13e9b5(0x79)]('.glb')&&!_0x91563e[_0x13e9b5(0xa4)][_0x13e9b5(0xf9)]()[_0x13e9b5(0x79)](_0x13e9b5(0xdc))){this[_0x13e9b5(0x93)][_0x13e9b5(0x99)]('Por\x20favor,\x20selecciona\x20un\x20archivo\x20GLB\x20o\x20GLTF\x20v√°lido',_0x13e9b5(0x7c));return;}if(this[_0x13e9b5(0x93)][_0x13e9b5(0xbc)][_0x13e9b5(0xd4)]){const _0x5d0c2b=this[_0x13e9b5(0x93)][_0x13e9b5(0xbc)][_0x13e9b5(0xd4)][_0x13e9b5(0xc6)]('/')[_0x13e9b5(0x81)]();await fetch('/api/delete-temp-file/'+_0x5d0c2b,{'method':_0x13e9b5(0xea)});}const _0x223685=new FormData();_0x223685[_0x13e9b5(0xf2)]('model',_0x91563e);const _0x2d236d=await fetch(_0x13e9b5(0xf4),{'method':_0x13e9b5(0xa3),'body':_0x223685});if(!_0x2d236d['ok'])throw new Error('Error\x20en\x20la\x20subida:\x20'+_0x2d236d[_0x13e9b5(0xff)]);const _0x540cf0=await _0x2d236d['json']();this[_0x13e9b5(0x93)]['projectData'][_0x13e9b5(0xd4)]=_0x540cf0[_0x13e9b5(0x98)],await this[_0x13e9b5(0x93)]['loadGLBModel'](_0x540cf0[_0x13e9b5(0x98)]),this[_0x13e9b5(0xe9)]=!![],this[_0x13e9b5(0xa9)](_0x540cf0['path']),this['adminInterface'][_0x13e9b5(0x99)](_0x13e9b5(0x96),'success');}